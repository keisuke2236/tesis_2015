%------------------------------------------------------%
%- 構成
%------------------------------------------------------%

まず初めに，命令した行動や発言を再現する出力に関してはUnityを用いて開発したソフトウェアを用いることにした．
その理由としてOSや機種に依存することがなく，ウェブブラウザ上で動作し，様々なデバイスから利用できることがあげられる．
そして今回私が開発を行った，この人工知能ハブはJavaのフレームワークであるMavenを用いて開発を行っている．
Mavenを選択したのはコンピュータ・ネットワーク用の通信規格の1つであるWebSocketを用いるためであり，
WebSocketを用いることでUnityで開発を行ったウェブブラウザ上で動作するキャラクターとの連携を容易にするからである．
また，共同研究の鈴木の開発しているデータベースはMONGODBを用いており，人工知能ハブの中でそのデータベースに問い合わせデータの取得を行っている．
\\
%------------------------------------------------------%
それでは私が開発した部分である人工知能ハブの中でどのように処理が行われているのかの解説を行う．
この人工知能ハブでは大きく分けて3つのステップで出力を作成している．\\

3つのステップ
\begin{itemize}
	\item{入力情報の解析}
	\item{解析された入力情報の保存}
	\item{解析データをもとに出力内容を作成する}
\end{itemize}
このように3つのステップを踏み，出力を作成しており各それぞれのステップごとに以下で解説を行います．
%------------------------------------------------------%
\section{3層で構成される入力情報の解析}
入力情報の解析は3つの層があります．
\begin{enumerate}
	\item{解析する内容ごとに振り分ける層}
	\item{入力内容の分野別に振り分ける層}
	\item{入力内容を実際に解析をかける層}
\end{enumerate}
以上の3つの層により，構成されています．
例えば会話相手が話しかけてきた場合，初めの解析する内容ごとに振り分ける層によって，会話から感情を推測したいのか
心的距離を推測したいのかに分かれます，次にその第一の層に所属している，解析する内容ごとに振り分ける層の中から
相手の発言内容を考慮し，最も適切な「分野を持つ」実際に解析をする第三の層を選びそこへ振り分けます．
そして最後の実際に解析をかける層で，今回は感情を推測したいのでその分野に適したプログラム（アルゴリズム）で解析します．
それでは実際に各層についての説明をしたいと思います．\\
%------------------------------------------------------%
\subsection{解析する内容ごとに振り分ける層}
第一の層，解析する内容ごとに振り分ける層についてです，
解析したい内容によって最終的に選択されるアルゴリズムは変わります．
この層に例えば「感情」を解析するものと「心的距離」を解析するものがある場合，入力された情報はその2つの層に渡され，
感情と心的距離の両方をそれぞれの層が持ってる適切なプログラムが解析し，データベースに保存されます．
%------------------------------------------------------%
\subsection{入力内容の分野別に振り分ける層}
第二の層，入力内容の分野別に振り分ける層では，入力された文章をGoogle検索に掛け，その結果を元にどの分野や話題の会話をしているのかを推測し，
適切な解析ができる層（プログラム）に振り分ける層です．\\

この層の下の実際に解析を行う，第三層に「料理」と「ゲーム」という分野があったとします．
その状態で，「クッパ\footnote{クッパ：クッパは韓国料理の一種。 スープとご飯を組み合わせた雑炊のような料理}って美味しいよね」という入力が来るとgoogle検索を用いて「クッパ　美味しい」という単語を検索し検索
結果
を取得，取得結果を形態素解析にかけ頻出単語表を作成します．
\\
そして「料理」のgoogle検索結果の頻出単語表と「ゲーム」の検索結果の頻出単語表を作成しておき，どちらの分野に解析を行わせるかを判断させます．
今回の場合は，実際にgoogleで検索してもらえれば分かりますが，2015年12月15日現在では，「料理」の解析層に振り分けられます．
\\
そして「クッパ\footnote{クッパ：スーパーマリオブラザーズというゲームに登場する敵キャラクター}って弱いよね」とユーザーが発言した場合google検索で「クッパ　弱い」と検索し頻出単語表を作成します．
すると「ゲーム」と検索して作成した頻出単語表との類似度が高いためゲームの解析層に振り分けられます．
\\
このように，入力に応じてそれぞれ適切な解析層に振り分ける構成になっています．
%------------------------------------------------------%
\subsection{入力内容に対して実際に解析をかける層}
第三の層，解析したい内容と分野や話題がわかっていることが前提で解析を行うことができる層です．
この層に所属する入力情報解析プログラムには「分野」と「返答のアルゴリズム」を記述し，
適切な，入力内容の分野別に振り分ける層（第二の層）に作成したこの層のプログラムを登録することで完成します．
例えば，「ゲーム」に関する感情を解析するプログラムを作成したら，
感情解析のプログラムを複数所持する第二層にこの層のプログラムを「ゲームの解析プログラム」として登録します．

このように分野がわかっている状態で解析を行うことができるため，以下のようなメリットがある．
それは会話の分野やジャンルによって変化する言葉の意味を捉えることができるようになるという点である．

例えば「クッパを落とした」という言葉は料理の分野ではマイナスイメージの単語であるが，
2015年12月15日現在，実際にgoogle検索をすると分かる通り，ゲームの分野に振り分けられる．
ゲームの分野のアルゴリズム部分に敵を定義し，それに対するマイナスイメージの単語はプラスイメージなことが起きた
というアルゴリズムを書くことで「クッパを落とした」という単語をプラスイメージの単語であると解析することができる．
\\
今回の例発言内容やアルゴリズムはあくまで1例だが，このように分野と入力方法を特定してあるので，
他にも男性が発言したのと女性が言ったのでは意味が違って受け取られる単語などにも対応することができる．
%------------------------------------------------------%
\section{解析情報の保存}
解析された情報は一貫して，人工知能ハブの中の全てのクラスで共有されているデータベースオブジェクトに保存される．
このデータベースオブジェクトはデータの保存や取り出しの際に様々なオブジェクトを保存可能にしている．
また，解析された情報は全てここに保存されるため，解析するプログラムの数が多ければ多いほ度様々な情報が蓄積し，
より高精度な出力を作成することができるようになる．


%------------------------------------------------------%
\section{解析と出力を作成する際の層の追加}

%------------------------------------------------------%
\subsection{解析と出力の分野を選ぶ層の追加}
%------------------------------------------------------%
\subsection{実際に解析する層の追加に}
%------------------------------------------------------%
